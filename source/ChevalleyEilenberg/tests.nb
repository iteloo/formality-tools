(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     40930,       1045]
NotebookOptionsPosition[     39307,        988]
NotebookOutlinePosition[     39857,       1009]
CellTagsIndexPosition[     39814,       1006]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Unit Tests for the ChevalleyEilenberg` package", "Title",
 CellChangeTimes->{{3.590080300394196*^9, 3.5900803157196827`*^9}, {
  3.598903361534802*^9, 3.5989033739015102`*^9}, {3.598903882214716*^9, 
  3.5989038891213417`*^9}, {3.598950334499453*^9, 3.5989503383260937`*^9}}],

Cell[CellGroupData[{

Cell["Setup", "Section",
 CellChangeTimes->{{3.590037145002685*^9, 3.59003715338137*^9}, {
  3.590037338403248*^9, 3.590037339340391*^9}, {3.5900801592555304`*^9, 
  3.590080160819013*^9}, {3.5988309447417707`*^9, 3.5988309455734873`*^9}}],

Cell[BoxData[{
 RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"Background", "\[Rule]", "LightGreen"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "FormalityTools`ChevalleyEilenberg`"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"<<", "FormalityTools`DglaHilbnC3`"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "we", " ", "will", " ", "also", " ", "test", " ", "private", " ", 
    "definitions"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrependTo", "[", 
   RowBox[{
   "$ContextPath", ",", "\"\<FormalityTools`DglaHilbnC3`Private`\>\""}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5901111141260853`*^9, 3.590111117027101*^9}, 
   3.590429315764176*^9, {3.5906395513904467`*^9, 3.5906395741266537`*^9}, {
   3.590639727954274*^9, 3.5906397289419622`*^9}, {3.590640677058509*^9, 
   3.590640795046383*^9}, {3.590694488220809*^9, 3.590694547672426*^9}, 
   3.598830940704482*^9, {3.59890337959201*^9, 3.5989033855140343`*^9}, {
   3.598905448980233*^9, 3.5989054607451773`*^9}, {3.598905983135598*^9, 
   3.59890599425417*^9}, {3.598950308114325*^9, 3.598950328285254*^9}, {
   3.599851892603868*^9, 3.5998519464929028`*^9}, 3.5998544207761593`*^9, {
   3.5998544650677156`*^9, 3.599854468456278*^9}, {3.599858797249795*^9, 
   3.5998588134038467`*^9}, 3.600759006307457*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TestAll", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"testPartitions", ",", "tests"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"testPartitions", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tests", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"standaloneTests", "=", 
      RowBox[{"{", "Test\[Chi]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "tests", " ", "that", " ", "do", " ", "not", " ", "need", " ", 
       "setup"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Running \>\"", ",", 
          RowBox[{"ToString", "[", "test", "]"}], ",", "\"\<...\>\""}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"test", "[", "]"}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"test", ",", "standaloneTests"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"tests", " ", "that", " ", "need", " ", "setup"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"SetupCEComplex", "[", "\[Mu]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Running \>\"", ",", 
             RowBox[{"ToString", "[", "test", "]"}], ",", 
             "\"\< on \[Mu]=\>\"", ",", "\[Mu]", ",", "\"\<...\>\""}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"test", "[", "]"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"test", ",", "tests"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CleanCEComplex", "[", "]"}], ";"}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", "testPartitions"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.599867391448639*^9, 3.599867400519464*^9}, {
   3.599867943268757*^9, 3.599867946779196*^9}, 3.599868044374866*^9, {
   3.5998680874500837`*^9, 3.599868117233012*^9}, {3.599868693020527*^9, 
   3.599868708820973*^9}, {3.599868823826111*^9, 3.599868829760865*^9}, {
   3.59986899675725*^9, 3.599869006946397*^9}, {3.5998693275349073`*^9, 
   3.599869333551136*^9}, {3.599869418548257*^9, 3.599869420723721*^9}, {
   3.599870146068955*^9, 3.5998701486409407`*^9}, {3.599877061276548*^9, 
   3.599877079362646*^9}, {3.599877125759625*^9, 3.5998771273362513`*^9}, {
   3.599878255142722*^9, 3.599878257476227*^9}, {3.599878723445459*^9, 
   3.599878726437711*^9}, {3.599879773191391*^9, 3.599879776498975*^9}, {
   3.599880169085762*^9, 3.5998803006592293`*^9}, {3.5998817267856617`*^9, 
   3.599881729054256*^9}, {3.599883550546603*^9, 3.59988355172289*^9}, {
   3.599885332117353*^9, 3.599885337233683*^9}, {3.599886901086247*^9, 
   3.599886905474987*^9}, {3.600759021386747*^9, 3.6007590330571613`*^9}, {
   3.600759077192247*^9, 3.6007591006108*^9}, {3.600759145506374*^9, 
   3.600759219137789*^9}}]
}, Open  ]],

Cell["DISCLAIMER: This notebook is unfinished and untested", "Section",
 CellChangeTimes->{{3.5989504854929132`*^9, 3.598950505286528*^9}}],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox["\[Delta]", "0"], "(", "e", ")"}], "=", "0"}], 
  TraditionalForm]], "None"]], "Section",
 CellChangeTimes->{{3.594017300220291*^9, 3.5940173148560257`*^9}, 
   3.5943405207589006`*^9}],

Cell[CellGroupData[{

Cell["Koszul sign", "Section",
 CellChangeTimes->{{3.593588206776116*^9, 3.593588219787787*^9}, 
   3.594340520761437*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ktest", "[", 
   RowBox[{"p_", ",", "q_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"\[Chi]", "[", 
      RowBox[{"\[Sigma]", ",", 
       RowBox[{
        RowBox[{"deg", "/@", "v"}], "/.", 
        RowBox[{"prod", "\[Rule]", "List"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"v", ",", 
       RowBox[{"L", "[", 
        RowBox[{"p", ",", "q"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Sigma]", ",", 
       RowBox[{"Permutations", "[", 
        RowBox[{"Range", "[", "p", "]"}], "]"}]}], "}"}]}], "]"}], "//", 
   "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.593587697904633*^9, 3.59358777492338*^9}, {
   3.593588042885387*^9, 3.593588043275167*^9}, 3.593588082533023*^9, {
   3.5935881133796*^9, 3.593588153084676*^9}, 3.59358819020016*^9, {
   3.593588226784301*^9, 3.593588249918562*^9}, 3.593588289890473*^9, 
   3.594340520761941*^9, {3.594434524424509*^9, 3.594434526992096*^9}, 
   3.600758961321454*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Apply", "[", 
   RowBox[{"Ktest", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "0"}], "}"}]}], "}"}], ",", "2"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.59358832110334*^9, 3.593588362563097*^9}, 
   3.5941994135976973`*^9, 3.594340520762905*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Chi]", "[", 
          RowBox[{"3", ",", "2", ",", "#"}], "]"}], ",", 
         RowBox[{"\[Chi]", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", "2"}], "}"}], ",", "#"}], "]"}]}], 
        "}"}], "&"}], "[", 
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "k"}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "4"}], "}"}]}], "]"}], "//", "MatrixForm"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.594432841013296*^9, 3.594432863131287*^9}, {
   3.594433157261397*^9, 3.5944331585987377`*^9}, 3.594447655894137*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Chi]", "[", 
          RowBox[{"3", ",", "1", ",", "#"}], "]"}], ",", 
         RowBox[{"\[Chi]", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"3", ",", "1", ",", "2"}], "}"}], ",", "#"}], "]"}]}], 
        "}"}], "&"}], "[", 
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "k"}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "4"}], "}"}]}], "]"}], "//", "MatrixForm"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5939588658704443`*^9, 3.593958895760674*^9}, {
   3.5939589398406897`*^9, 3.593959013762185*^9}, {3.593959471951069*^9, 
   3.593959501988043*^9}, {3.593959584935429*^9, 3.593959588837318*^9}, {
   3.593959913357855*^9, 3.5939599954526453`*^9}, {3.593960069346805*^9, 
   3.593960147386343*^9}, 3.594340520763995*^9, {3.594365832544042*^9, 
   3.5943658482770557`*^9}, {3.59436587902247*^9, 3.594365889283946*^9}, {
   3.594365957672464*^9, 3.594365962013647*^9}, {3.594367040344857*^9, 
   3.594367041771495*^9}, {3.59436707949084*^9, 3.594367081242852*^9}, {
   3.594433963983451*^9, 3.594433971979865*^9}, {3.5944340260988503`*^9, 
   3.594434039871978*^9}, {3.594434342019421*^9, 3.594434342907394*^9}, 
   3.5944476573229237`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Chi]", "[", 
          RowBox[{"2", ",", "#"}], "]"}], ",", 
         RowBox[{"\[Chi]", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "3", ",", "2"}], "}"}], ",", "#"}], "]"}]}], 
        "}"}], "&"}], "[", 
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "k"}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "4"}], "}"}]}], "]"}], "//", "MatrixForm"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.593959181757929*^9, 3.593959197248448*^9}, {
   3.59396011368519*^9, 3.593960135729657*^9}, 3.5943405207666607`*^9, {
   3.594366012856327*^9, 3.59436601393143*^9}, {3.594367096483666*^9, 
   3.5943671018592567`*^9}, 3.594447658653376*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["differentials", "Section",
 CellChangeTimes->{{3.594447668882251*^9, 3.5944476700885143`*^9}, {
  3.600758928627369*^9, 3.600758937130549*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[Delta]0", "[", 
       RowBox[{"i", ",", 
        RowBox[{"j", "+", "1"}]}], "]"}], ".", 
      RowBox[{"\[Delta]0", "[", 
       RowBox[{"i", ",", "j"}], "]"}], ".", 
      RowBox[{"\[Alpha]", "[", 
       RowBox[{"i", ",", "j"}], "]"}]}], "//", "SparseArray"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.594435213335627*^9, 3.594435253157139*^9}, {
  3.594435286331645*^9, 3.594435287650363*^9}, {3.594435390685203*^9, 
  3.594435416514554*^9}, {3.594435459891179*^9, 3.594435490167148*^9}, {
  3.594435992080983*^9, 3.594435998461259*^9}, {3.594436232734104*^9, 
  3.594436234992815*^9}, {3.594436287497409*^9, 3.594436289242017*^9}, {
  3.5944472044423018`*^9, 3.5944472205471783`*^9}, {3.594447675334898*^9, 
  3.5944476850287848`*^9}, {3.5944479334856777`*^9, 3.5944479346490107`*^9}, {
  3.600758930812065*^9, 3.600758933685419*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\[Delta]1", "[", 
       RowBox[{
        RowBox[{"i", "+", "1"}], ",", "j"}], "]"}], ".", 
      RowBox[{"\[Delta]1", "[", 
       RowBox[{"i", ",", "j"}], "]"}], ".", 
      RowBox[{"\[Alpha]", "[", 
       RowBox[{"i", ",", "j"}], "]"}]}], "//", "SparseArray"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.594435213335627*^9, 3.594435253157139*^9}, {
  3.594435286331645*^9, 3.594435287650363*^9}, {3.594435390685203*^9, 
  3.594435416514554*^9}, {3.594435459891179*^9, 3.594435490167148*^9}, {
  3.594435992080983*^9, 3.594435998461259*^9}, {3.594436232734104*^9, 
  3.594436234992815*^9}, {3.594436287497409*^9, 3.594436289242017*^9}, {
  3.5944472044423018`*^9, 3.5944472205471783`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Delta]0", "[", 
          RowBox[{
           RowBox[{"i", "+", "1"}], ",", "j"}], "]"}], ".", 
         RowBox[{"\[Delta]1", "[", 
          RowBox[{"i", ",", "j"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"\[Delta]1", "[", 
          RowBox[{"i", ",", 
           RowBox[{"j", "+", "1"}]}], "]"}], ".", 
         RowBox[{"\[Delta]0", "[", 
          RowBox[{"i", ",", "j"}], "]"}]}]}], ")"}], ".", 
      RowBox[{"\[Alpha]", "[", 
       RowBox[{"i", ",", "j"}], "]"}]}], "//", "SparseArray"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.594435213335627*^9, 3.594435253157139*^9}, {
  3.594435286331645*^9, 3.594435287650363*^9}, {3.594435390685203*^9, 
  3.594435416514554*^9}, {3.594435459891179*^9, 3.594435490167148*^9}, {
  3.594435992080983*^9, 3.594435998461259*^9}, {3.594436232734104*^9, 
  3.594436234992815*^9}, {3.594436287497409*^9, 3.594436289242017*^9}, {
  3.5944472044423018`*^9, 3.5944472205471783`*^9}, {3.594447736230734*^9, 
  3.5944477953080263`*^9}, {3.594447867379603*^9, 3.594447917707493*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing against legacy", "Section",
 CellChangeTimes->{{3.594371330107081*^9, 3.59437133288595*^9}, {
  3.59895040230652*^9, 3.598950408440399*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"returns", " ", "matrix", " ", "for", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        SubscriptBox["\[Delta]", "0"], ")"}], 
       RowBox[{"p", ",", "q"}]]}], ":", 
     SuperscriptBox["A", 
      RowBox[{"p", ",", "q"}]]}], "\[Rule]", 
    SuperscriptBox["A", 
     RowBox[{"p", ",", 
      RowBox[{"q", "+", "1"}]}]]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Delta]0Old", "[", 
    RowBox[{"p_", ",", "q_"}], "]"}], ":=", 
   RowBox[{"\[Delta]0Old", "=", 
    RowBox[{
     RowBox[{"[", 
      RowBox[{"p", ",", "q"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"v", ",", "vi", ",", "w", ",", "wi"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Computing \[Delta]0Old[\>\"", ",", "p", ",", "\"\<,\>\"", ",",
             "q", ",", "\"\<]...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"(", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"vi", ",", "v"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"wi", ",", "w"}], "}"}]}], "}"}], "=", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"V", ",", "W"}], "}"}], "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"map", "\[Rule]", "List"}], ",", 
                  RowBox[{"prod", "\[Rule]", "List"}]}], "}"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Delta]", "[", 
                 RowBox[{"wi", ",", "vi"}], "]"}], 
                RowBox[{"d", "[", 
                 RowBox[{"v", ",", "w"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"-", "1"}], ")"}], "^", "q"}], " ", 
                RowBox[{"Sum", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Delta]", "[", 
                    RowBox[{"v", ",", "w"}], "]"}], 
                   RowBox[{"\[Delta]", "[", 
                    RowBox[{
                    RowBox[{"Drop", "[", 
                    RowBox[{"vi", ",", 
                    RowBox[{"{", "i", "}"}]}], "]"}], ",", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"wi", ",", 
                    RowBox[{"{", "i", "}"}]}], "]"}]}], "]"}], 
                   RowBox[{"d", "[", 
                    RowBox[{
                    RowBox[{"wi", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"vi", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                    RowBox[{"Total", "[", 
                    RowBox[{"deg", "/@", 
                    RowBox[{"vi", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{"i", "-", "1"}]}], "]"}], "]"}]}], "]"}]}]}], 
                  "\[IndentingNewLine]", ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "wi", "]"}]}], "}"}]}], 
                 "]"}]}]}]}], "\[IndentingNewLine]", ")"}], ",", 
            RowBox[{"{", 
             RowBox[{"V", ",", 
              RowBox[{"A", "[", 
               RowBox[{"p", ",", 
                RowBox[{"q", "+", "1"}]}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"W", ",", 
              RowBox[{"A", "[", 
               RowBox[{"p", ",", "q"}], "]"}]}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], "//", "SparseArray"}], "//", 
      "absTiming"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.593571446046501*^9, 3.593571446622284*^9}, {
   3.593573326817165*^9, 3.593573518044929*^9}, {3.593573606772441*^9, 
   3.593573610139447*^9}, {3.5935743450979137`*^9, 3.5935743544660463`*^9}, {
   3.5935744173079844`*^9, 3.593574434537965*^9}, {3.5935746018718443`*^9, 
   3.59357466684538*^9}, {3.593574747647929*^9, 3.5935748927137547`*^9}, {
   3.593575271082816*^9, 3.5935752996322107`*^9}, 3.5935753448779383`*^9, {
   3.59357564918015*^9, 3.593575662921584*^9}, {3.5935760336668262`*^9, 
   3.593576081535137*^9}, {3.593576219207594*^9, 3.593576266300695*^9}, {
   3.5935763010601797`*^9, 3.593576384028775*^9}, {3.593576442563958*^9, 
   3.5935766932638206`*^9}, {3.59357672611747*^9, 3.59357675279707*^9}, 
   3.593576867317634*^9, {3.593576987380722*^9, 3.593577008781404*^9}, {
   3.594004173241493*^9, 3.5940041762943172`*^9}, {3.594004472172443*^9, 
   3.5940044798053217`*^9}, {3.594004609640486*^9, 3.594004630870591*^9}, {
   3.594012280277294*^9, 3.5940123243765182`*^9}, {3.594013967850178*^9, 
   3.5940139697927027`*^9}, {3.5940142527518806`*^9, 
   3.5940142590105257`*^9}, {3.594015283397241*^9, 3.594015306290411*^9}, {
   3.5940157737358437`*^9, 3.594015789105626*^9}, {3.594015983601059*^9, 
   3.594016019861882*^9}, {3.594086556244171*^9, 3.594086562901195*^9}, {
   3.594090950007453*^9, 3.5940909533975563`*^9}, {3.594095068753401*^9, 
   3.59409507087894*^9}, {3.594103493846901*^9, 3.59410349556736*^9}, {
   3.594103563512225*^9, 3.59410362516171*^9}, {3.594103961452093*^9, 
   3.594103963066471*^9}, 3.594340520731492*^9, {3.594365757649712*^9, 
   3.594365758129099*^9}, {3.5943658011552057`*^9, 3.594365801425461*^9}, {
   3.594371300105339*^9, 3.594371300480316*^9}, {3.594371502977634*^9, 
   3.594371503259617*^9}, {3.594372273062813*^9, 3.594372273362376*^9}, {
   3.594372704825684*^9, 3.5943727148677588`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"returns", " ", "matrix", " ", "for", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        SubscriptBox["\[Delta]", "1"], ")"}], 
       RowBox[{"p", ",", "q"}]]}], ":", 
     SuperscriptBox["A", 
      RowBox[{"p", ",", "q"}]]}], "\[Rule]", 
    SuperscriptBox["A", 
     RowBox[{
      RowBox[{"p", "+", "1"}], ",", "q"}]]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\[Delta]1Old", "[", 
    RowBox[{"p_", ",", "q_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[Delta]1Old", "[", 
     RowBox[{"p", ",", "q"}], "]"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"v", ",", "vi", ",", "w", ",", "wi"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Computing \[Delta]1Old[\>\"", ",", "p", ",", "\"\<,\>\"", ",", 
           "q", ",", "\"\<]...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"vi", ",", "v"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"wi", ",", "w"}], "}"}]}], "}"}], "=", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"V", ",", "W"}], "}"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"map", "\[Rule]", "List"}], ",", 
                 RowBox[{"prod", "\[Rule]", "List"}]}], "}"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"-", "1"}], ")"}], "^", 
               RowBox[{"(", 
                RowBox[{"q", "+", "p"}], ")"}]}], 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Delta]", "[", 
                    RowBox[{"wi", ",", 
                    RowBox[{"Drop", "[", 
                    RowBox[{"vi", ",", 
                    RowBox[{"{", "i", "}"}]}], "]"}]}], "]"}], 
                   RowBox[{"c", "[", 
                    RowBox[{"v", ",", "w", ",", 
                    RowBox[{"vi", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], 
                   RowBox[{"\[Chi]", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"deg", "/@", "vi"}]}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "vi", "]"}]}], "}"}]}], "]"}], 
                "\[IndentingNewLine]", "-", 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Delta]", "[", 
                    RowBox[{"v", ",", "w"}], "]"}], 
                   RowBox[{"\[Delta]", "[", 
                    RowBox[{
                    RowBox[{"wi", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
                    RowBox[{"Delete", "[", 
                    RowBox[{"vi", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "i", "}"}], ",", 
                    RowBox[{"{", "j", "}"}]}], "}"}]}], "]"}]}], "]"}], 
                   RowBox[{"c", "[", 
                    RowBox[{
                    RowBox[{"wi", "[", 
                    RowBox[{"[", "p", "]"}], "]"}], ",", 
                    RowBox[{"vi", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"vi", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], 
                   RowBox[{"\[Chi]", "[", 
                    RowBox[{"i", ",", "j", ",", 
                    RowBox[{"deg", "/@", "vi"}]}], "]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "vi", "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", 
                    RowBox[{"i", "+", "1"}], ",", 
                    RowBox[{"Length", "[", "vi", "]"}]}], "}"}]}], "]"}]}], 
               "\[IndentingNewLine]", ")"}]}]}], "\[IndentingNewLine]", ")"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"V", ",", 
             RowBox[{"A", "[", 
              RowBox[{
               RowBox[{"p", "+", "1"}], ",", "q"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"W", ",", 
             RowBox[{"A", "[", 
              RowBox[{"p", ",", "q"}], "]"}]}], "}"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], "//", "SparseArray"}], "//", 
     "absTiming"}]}]}]}]], "Input",
 CellChangeTimes->{{3.593577097345121*^9, 3.593577147978183*^9}, {
   3.593577221055501*^9, 3.593577281202677*^9}, {3.593588420586961*^9, 
   3.593588483095187*^9}, {3.593589249343451*^9, 3.593589270614729*^9}, {
   3.59374543199446*^9, 3.5937454323636703`*^9}, 3.593848229977715*^9, {
   3.59395702510489*^9, 3.593957026125444*^9}, {3.593957088590713*^9, 
   3.593957322899942*^9}, {3.5939573586508207`*^9, 3.593957387876748*^9}, {
   3.593957515919664*^9, 3.5939575967690773`*^9}, {3.5939576721067133`*^9, 
   3.593957672319289*^9}, {3.593957791151841*^9, 3.5939577917658043`*^9}, {
   3.59395785058324*^9, 3.593957857544614*^9}, {3.5939584305184717`*^9, 
   3.593958433678197*^9}, {3.593990671459236*^9, 3.5939906783783712`*^9}, {
   3.594004168845394*^9, 3.594004170561687*^9}, {3.5940044838714657`*^9, 
   3.594004489487521*^9}, {3.5940046140902977`*^9, 3.5940046182658873`*^9}, {
   3.5940125992998466`*^9, 3.59401260153312*^9}, {3.594014556829913*^9, 
   3.594014559225499*^9}, {3.5940178598936367`*^9, 3.5940178611297283`*^9}, {
   3.594017937041834*^9, 3.594017938544972*^9}, {3.59401849258375*^9, 
   3.594018565178451*^9}, {3.594018938072521*^9, 3.5940189401499023`*^9}, {
   3.5940190144503117`*^9, 3.5940190179184847`*^9}, {3.5940669098661127`*^9, 
   3.594066928140356*^9}, {3.594086565340748*^9, 3.5940865692073517`*^9}, {
   3.594090955278907*^9, 3.59409095885635*^9}, {3.594095072417603*^9, 
   3.594095077552657*^9}, {3.594103497505723*^9, 3.594103499796896*^9}, {
   3.594103620702598*^9, 3.59410362919389*^9}, {3.594103964757018*^9, 
   3.5941039663231773`*^9}, 3.594340520733745*^9, {3.594365379455892*^9, 
   3.5943653873899384`*^9}, {3.594365603591481*^9, 3.5943656187346153`*^9}, {
   3.5943657498703537`*^9, 3.59436575031619*^9}, {3.594365804832815*^9, 
   3.5943658158006983`*^9}, {3.594371294211442*^9, 3.5943712975874033`*^9}, {
   3.594371504779358*^9, 3.594371505043667*^9}, {3.594372270353038*^9, 
   3.5943722711600533`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Delta]0Old2", "[", 
   RowBox[{"p_", ",", "q_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"\[Delta]0Old2", "[", 
    RowBox[{"p", ",", "q"}], "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "J", ",", "j", ",", "K", ",", "k", ",", "Jdim", ",", "jdim", ",", 
          "Kdim", ",", "kdim", ",", "cases", ",", "flattenIndices"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Computing \[Delta]0Old2[\>\"", ",", "p", ",", "\"\<,\>\"", ",",
            "q", ",", "\"\<]...\>\""}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cases", "[", "i_", "]"}], ":=", 
          RowBox[{
           RowBox[{"cases", "[", "i", "]"}], "=", 
           RowBox[{"Normal", "[", 
            RowBox[{"SparseArray", "[", 
             RowBox[{
              RowBox[{"i", "\[Rule]", 
               RowBox[{"-", "1"}]}], ",", 
              RowBox[{"{", "p", "}"}]}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cases", "[", "0", "]"}], "=", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"0", ",", "p"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"flattenIndices", "[", "m_", "]"}], ":=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"m", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", 
                 RowBox[{"Dimensions", "[", "m", "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{";;", ";;", "2"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", 
                 RowBox[{"Dimensions", "[", "m", "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"2", ";;", ";;", "2"}], "]"}], "]"}]}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"(", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"J", ",", "j"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"K", ",", "k"}], "}"}]}], "}"}], "=", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"V", ",", "W"}], "}"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"map", "\[Rule]", "List"}], ",", 
                 RowBox[{"prod", "\[Rule]", "List"}]}], "}"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Jdim", ",", "jdim", ",", "Kdim", ",", "kdim"}], "}"}],
               "=", 
              RowBox[{"Map", "[", 
               RowBox[{"dim", ",", 
                RowBox[{"{", 
                 RowBox[{"J", ",", "j", ",", "K", ",", "k"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"-", "1"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Switch", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"J", ",", "j"}], "}"}], "-", 
                  RowBox[{"{", 
                   RowBox[{"K", ",", "k"}], "}"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"cases", "[", "0", "]"}], ",", "1"}], "}"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"flattenIndices", "[", 
                  RowBox[{"Outer", "[", 
                   RowBox[{"Times", ",", 
                    RowBox[{"IdentityMatrix", "[", 
                    RowBox[{"Times", "@@", "Kdim"}], "]"}], ",", 
                    RowBox[{"d", "[", "k", "]"}]}], "]"}], "]"}], ",", 
                 "\[IndentingNewLine]", "##", ",", "\[IndentingNewLine]", "_",
                  ",", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"jdim", " ", 
                    RowBox[{"Times", "@@", "Jdim"}]}], ",", 
                    RowBox[{"kdim", " ", 
                    RowBox[{"Times", "@@", "Kdim"}]}]}], "}"}]}], "]"}]}], 
                "\[IndentingNewLine]", "]"}], "&"}], "@@", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"cases", "[", "i", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], "^", 
                    RowBox[{"(", 
                    RowBox[{"q", "+", 
                    RowBox[{"Total", "[", 
                    RowBox[{"K", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{"i", "-", "1"}]}], "]"}], "]"}], "]"}]}], 
                    ")"}]}]}], 
                    RowBox[{"flattenIndices", "[", 
                    RowBox[{"Outer", "[", 
                    RowBox[{"Times", ",", 
                    RowBox[{"IdentityMatrix", "[", 
                    RowBox[{"Times", "@@", 
                    RowBox[{"Kdim", "[", 
                    RowBox[{"[", 
                    RowBox[{";;", 
                    RowBox[{"i", "-", "1"}]}], "]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Transpose", "[", 
                    RowBox[{"d", "[", 
                    RowBox[{
                    RowBox[{"K", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", "1"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"IdentityMatrix", "[", 
                    RowBox[{"kdim", " ", 
                    RowBox[{"Times", "@@", 
                    RowBox[{"Kdim", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "1"}], ";;"}], "]"}], "]"}]}]}], 
                    "]"}]}], "]"}], "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "p"}], "}"}]}], "]"}], ",", "1"}], 
               "]"}]}]}], "\[IndentingNewLine]", ")"}], ",", 
           RowBox[{"{", 
            RowBox[{"V", ",", 
             RowBox[{"AI", "[", 
              RowBox[{"p", ",", 
               RowBox[{"q", "+", "1"}]}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"W", ",", 
             RowBox[{"AI", "[", 
              RowBox[{"p", ",", "q"}], "]"}]}], "}"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], "//", "ArrayFlatten"}], "//", 
     "SparseArray"}], "//", "absTiming"}]}]}]], "Input",
 CellChangeTimes->{{3.5943735355864*^9, 3.5943735622915792`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"d", "[", "i", "]"}], "=", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "\[Equal]", "top"}], ",", "0", ",", 
          RowBox[{"dim", "[", 
           RowBox[{"i", "+", "1"}], "]"}]}], "]"}], ",", 
        RowBox[{"dim", "[", "i", "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"i", ",", "j"}], "]"}], "=", 
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "+", "j"}], "\[GreaterEqual]", "top"}], ",", "0", ",", 
          RowBox[{"dim", "[", 
           RowBox[{"i", "+", "j"}], "]"}]}], "]"}], ",", 
        RowBox[{"dim", "[", "i", "]"}], ",", 
        RowBox[{"dim", "[", "j", "]"}]}], "}"}]}], "]"}]}]}], ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"d", "[", 
     RowBox[{"v_", ",", "w_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"d", "[", 
      RowBox[{"v", ",", "w"}], "]"}], "=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"deg", "[", "v", "]"}], "-", 
         RowBox[{"deg", "[", "w", "]"}]}], "\[Equal]", "1"}], ",", 
       RowBox[{
        RowBox[{"d", "[", 
         RowBox[{"deg", "[", "w", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"w", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", "0"}], 
      "]"}]}]}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c", "[", 
    RowBox[{"v_", ",", "w1_", ",", "w2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"c", "[", 
     RowBox[{"v", ",", "w1", ",", "w2"}], "]"}], "=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"deg", "[", "v", "]"}], "-", 
        RowBox[{"deg", "[", "w1", "]"}], "-", 
        RowBox[{"deg", "[", "w2", "]"}]}], "\[Equal]", "0"}], ",", 
      RowBox[{
       RowBox[{"c", "[", 
        RowBox[{
         RowBox[{"deg", "[", "w1", "]"}], ",", 
         RowBox[{"deg", "[", "w2", "]"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"w1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"w2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", "0"}], 
     "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5950381482618628`*^9, 3.5950381486938467`*^9}}]
}, Closed]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
Evaluator->"Local",
WindowSize->{1278, 1396},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
ShowSelection->True,
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.5, 1.5 Inherited],
Background->RGBColor[0.88, 1, 0.88],
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (February 18, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 281, 3, 185, "Title"],
Cell[CellGroupData[{
Cell[728, 22, 239, 3, 100, "Section"],
Cell[970, 27, 1462, 29, 156, "Input"],
Cell[2435, 58, 4402, 99, 593, "Input"]
}, Open  ]],
Cell[6852, 160, 139, 1, 100, "Section"],
Cell[6994, 163, 263, 7, 53, "Section"],
Cell[CellGroupData[{
Cell[7282, 174, 122, 2, 53, "Section"],
Cell[7407, 178, 1018, 26, 42, "Input"],
Cell[8428, 206, 523, 16, 40, "Input"],
Cell[8954, 224, 868, 26, 40, "Input"],
Cell[9825, 252, 1486, 35, 40, "Input"],
Cell[11314, 289, 980, 28, 40, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12331, 322, 149, 2, 100, "Section"],
Cell[12483, 326, 1123, 26, 40, "Input"],
Cell[13609, 354, 973, 24, 40, "Input"],
Cell[14585, 380, 1368, 34, 64, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15990, 419, 154, 2, 100, "Section"],
Cell[16147, 423, 5988, 132, 253, "Input"],
Cell[22138, 557, 6948, 154, 298, "Input"],
Cell[29089, 713, 7274, 177, 482, "Input"],
Cell[36366, 892, 1175, 37, 66, "Input"],
Cell[37544, 931, 1735, 53, 89, "Input"]
}, Closed]]
}, Open  ]]
}
]
*)

