(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     47966,       1268]
NotebookOptionsPosition[     43976,       1130]
NotebookOutlinePosition[     44407,       1148]
CellTagsIndexPosition[     44364,       1145]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Setup", "Section",
 CellChangeTimes->{{3.590037145002685*^9, 3.59003715338137*^9}, {
  3.590037338403248*^9, 3.590037339340391*^9}, {3.5900801592555304`*^9, 
  3.590080160819013*^9}, {3.5988309447417707`*^9, 3.5988309455734873`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"Background", "\[Rule]", "LightGreen"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.5901111141260853`*^9, 3.590111117027101*^9}, 
   3.590429315764176*^9, {3.5906395513904467`*^9, 3.5906395741266537`*^9}, {
   3.590639727954274*^9, 3.5906397289419622`*^9}, {3.590640677058509*^9, 
   3.590640795046383*^9}, {3.590694488220809*^9, 3.590694547672426*^9}, 
   3.598830940704482*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Remove", "::", "\<\"rmnsm\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"There are no symbols \
matching \\\\\\\\\\\\\\\"\\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(\\\"Global`*\\\"\\), \\\"MT\\\
\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\"\\\\\\\\\\\\\\\".\\\\\\\"\\\", \
\\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Remove/rmnsm\\\", ButtonNote -> \
\\\"Remove::rmnsm\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.607479510891857*^9, 3.607479548206399*^9}, 
   3.6074795991685123`*^9, 3.607479635313093*^9, 3.60747968289655*^9, 
   3.6074797206594276`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Begin Package", "Section",
 InitializationGroup->True,
 CellChangeTimes->{{3.598831399413019*^9, 3.598831400987857*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", "\"\<FormalityTools`SmartTensor`\>\"", "]"}], 
  ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.598829475229063*^9, 3.598829478261488*^9}, 
   3.598831440104094*^9, {3.598831952187162*^9, 3.5988319644094954`*^9}, {
   3.598833274616651*^9, 3.598833293695784*^9}, {3.598905347051097*^9, 
   3.598905355750904*^9}, {3.5989054307688217`*^9, 3.598905437638081*^9}, {
   3.599854626767277*^9, 3.599854628244357*^9}, {3.6074698850605516`*^9, 
   3.6074698936124563`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SmartTensor", "::", "usage"}], "=", "\"\<A smart tensor.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SmartTensorQ", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Forget", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Pair", "::", "usage"}], "=", "\"\<\>\""}], ";"}]}], "Input",
 CellChangeTimes->{{3.6074700527942247`*^9, 3.607470065664472*^9}, 
   3.607472003090768*^9, {3.6074723518614063`*^9, 3.6074723601593037`*^9}, {
   3.607478420841889*^9, 3.607478427472818*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.598829499388723*^9, 3.598829508019981*^9}, 
   3.598833295974461*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Core", "Section",
 InitializationGroup->True,
 CellChangeTimes->{{3.607469849173068*^9, 3.6074698502593803`*^9}, {
  3.6074702267476587`*^9, 3.607470227362853*^9}}],

Cell[BoxData[""], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.6074698542098093`*^9, 3.607469854628304*^9}}],

Cell[TextData[{
 "The data of a ",
 StyleBox["SmartTensor", "Code"],
 " consists of a tensor in the form of a nested list, and a list of basis for \
each factor space. I.e. it is an expression of the form ",
 StyleBox["SmartTensor[tensor_, bases_]", "Code"],
 ". Two ",
 StyleBox["SmartTensors", "Code"],
 " are considered equal if and only if the tensor and bases are individually \
equal. "
}], "Text",
 InitializationGroup->True,
 CellChangeTimes->{
  3.6074573061245947`*^9, {3.607457370042935*^9, 3.607457551334139*^9}, {
   3.6074577128585*^9, 3.607457723238929*^9}, {3.6074582811562967`*^9, 
   3.607458283610154*^9}, {3.60745956145995*^9, 3.607459614654935*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SmartTensor", "[", 
  RowBox[{"tensor_", ",", "bases_"}], "]"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.607457257578164*^9, 3.6074572636156683`*^9}, {
  3.607457486577868*^9, 3.607457490469215*^9}, {3.607458275340117*^9, 
  3.607458278147684*^9}}],

Cell[BoxData[
 RowBox[{"SmartTensor", "[", 
  RowBox[{"tensor_", ",", "bases_"}], "]"}]], "Output",
 InitializationGroup->True,
 CellChangeTimes->{
  3.607461633325699*^9, 3.607461756415588*^9, 3.607461821007702*^9, {
   3.60746188813013*^9, 3.607461913807782*^9}, 3.607461967470438*^9, 
   3.607462097831437*^9, 3.607462195367557*^9, {3.60746231603574*^9, 
   3.60746232140025*^9}, {3.6074623920751953`*^9, 3.607462437182249*^9}, 
   3.607462483362466*^9, 3.607462530752036*^9, {3.607462648107902*^9, 
   3.607462693437091*^9}, {3.6074627466882257`*^9, 3.607462803690967*^9}, 
   3.6074628945520163`*^9, {3.6074636128843613`*^9, 3.607463621252384*^9}, 
   3.607463687972702*^9, 3.607463738830185*^9, 3.607463769174088*^9, 
   3.6074638905072327`*^9, {3.607463978605281*^9, 3.6074640138930883`*^9}, {
   3.607464055267105*^9, 3.6074640598260803`*^9}, {3.607464148131516*^9, 
   3.607464162314723*^9}, {3.607464228481539*^9, 3.6074642477434187`*^9}, 
   3.607464321945528*^9, {3.607464354376203*^9, 3.607464375545767*^9}, 
   3.607464512803629*^9, {3.607464659231826*^9, 3.607464679665432*^9}, 
   3.607469870759389*^9, 3.607469977725565*^9, 3.607470008409358*^9, 
   3.6074702749193993`*^9, 3.607470338983305*^9, {3.607471022228928*^9, 
   3.607471042382759*^9}, 3.6074716748806562`*^9, 3.60747175714224*^9, {
   3.607471790638867*^9, 3.607471808722447*^9}, 3.607471897385558*^9, 
   3.607471977638439*^9, {3.607472069915484*^9, 3.607472095788897*^9}, {
   3.607472138995838*^9, 3.607472140096685*^9}, 3.607472315827167*^9, 
   3.607472361295269*^9, {3.6074724276909323`*^9, 3.607472466380063*^9}, {
   3.607472502928475*^9, 3.607472555965899*^9}, {3.607472598079844*^9, 
   3.607472668628599*^9}, 3.6074745489240913`*^9, 3.607475842744779*^9, 
   3.607479218702675*^9, {3.6074795199149733`*^9, 3.607479548557066*^9}, 
   3.6074795996051207`*^9, 3.607479635682734*^9, 3.6074796831972647`*^9, 
   3.607479720982465*^9}]
}, Open  ]],

Cell["Todo: make sure basis does not contain duplicates", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.607460931838438*^9, 3.607460942440194*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SmartTensorQ", "[", 
    RowBox[{"expr_", ",", 
     RowBox[{"patt_:", "None"}], ",", 
     RowBox[{"test_:", "None"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Head", "[", "expr", "]"}], "===", "SmartTensor"}], "&&", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"patt", "=!=", "None"}], ",", 
      RowBox[{"MatchQ", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Depth", "[", 
          RowBox[{"Forget", "[", "expr", "]"}], "]"}], "-", "1"}], ",", 
        "patt"}], "]"}], ",", "True"}], "]"}], "&&", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"test", "=!=", "None"}], ",", 
      RowBox[{"And", "@@", 
       RowBox[{"test", "/@", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Forget", "[", "expr", "]"}], "]"}]}]}], ",", "True"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixQ", "[", 
   RowBox[{
    RowBox[{"SmartTensor", "[", 
     RowBox[{"t_", ",", "b_"}], "]"}], ",", "opt___"}], "]"}], "^:=", 
  RowBox[{"MatrixQ", "[", 
   RowBox[{"t", ",", "opt"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArrayQ", "[", 
   RowBox[{
    RowBox[{"SmartTensor", "[", 
     RowBox[{"t_", ",", "b_"}], "]"}], ",", "opt___"}], "]"}], "^:=", 
  RowBox[{"ArrayQ", "[", 
   RowBox[{"t", ",", "opt"}], "]"}]}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.6074701833957*^9, 3.607470184237781*^9}, {
   3.607470234772213*^9, 3.6074702848279963`*^9}, {3.6074703214289913`*^9, 
   3.607470337347354*^9}, {3.607478395869431*^9, 3.607478432691519*^9}, {
   3.607478485089164*^9, 3.607478519183023*^9}, {3.6074788519466248`*^9, 
   3.607478904661229*^9}, {3.607478973698122*^9, 3.607479042081339*^9}, {
   3.607479075578947*^9, 3.607479076336944*^9}, {3.607479166893972*^9, 
   3.607479201168681*^9}, {3.607479265584697*^9, 3.6074794089402523`*^9}, {
   3.6074794617837543`*^9, 3.6074795035780277`*^9}, {3.607479538744328*^9, 
   3.6074795471369677`*^9}, {3.6074795858978643`*^9, 3.6074795971362*^9}, 
   3.607479633378471*^9, {3.6074797103263197`*^9, 3.607479719587077*^9}}],

Cell[TextData[{
 "The ",
 StyleBox["Forget", "Code"],
 " operation simply returns the underlying tensor. "
}], "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.60745826030844*^9, 3.6074582734659777`*^9}, {
  3.6074605083794403`*^9, 3.60746051261499*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Forget", "[", 
   RowBox[{"SmartTensor", "[", 
    RowBox[{"t_", ",", "b_"}], "]"}], "]"}], "^:=", "t"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.607458226875003*^9, 3.607458254932136*^9}, {
  3.607458290411165*^9, 3.6074583028435*^9}}],

Cell[TextData[{
 "The ",
 StyleBox["Flatten", "Code"],
 " operation returns a linear combination of the tensor basis elements. "
}], "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.607457642833262*^9, 3.607457701486397*^9}, {
  3.607457735371167*^9, 3.607457736031159*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Flatten", "[", 
   RowBox[{"SmartTensor", "[", "st__", "]"}], "]"}], "^:=", 
  RowBox[{"Plus", "@@", 
   RowBox[{"Times", "@@@", 
    RowBox[{"Pair", "[", 
     RowBox[{"SmartTensor", "[", "st", "]"}], "]"}]}]}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.607457614192732*^9, 3.60745763808875*^9}, {
   3.607459641620146*^9, 3.607459645033114*^9}, {3.607459941618767*^9, 
   3.6074600655672207`*^9}, 3.607460162073325*^9, 3.60746180486655*^9, {
   3.607470986495337*^9, 3.607471016595109*^9}, {3.607471805523346*^9, 
   3.607471807639041*^9}, {3.6074720943389874`*^9, 3.607472094705798*^9}, {
   3.607472535246578*^9, 3.6074725393679256`*^9}, {3.607472654391883*^9, 
   3.607472657701785*^9}}],

Cell[BoxData[
 RowBox[{"SmartTensor", "/:", 
  RowBox[{"Pair", "[", 
   RowBox[{"SmartTensor", "[", 
    RowBox[{"t_", ",", "b_"}], "]"}], "]"}], ":=", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Flatten", "[", "t", "]"}], ",", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Outer", "[", 
         RowBox[{"CircleTimes", ",", "##"}], "]"}], "&"}], "@@", "b"}], 
      "]"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.607471969825748*^9, 3.60747197632631*^9}, {
  3.607472090727077*^9, 3.6074720928594637`*^9}}],

Cell["## Problem: CircleTime is not associative by default", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.607460325872383*^9, 3.60746033534909*^9}}],

Cell["\<\
This returns the coefficient corresponding to a basis element in the vector \
space. \
\>", "Text",
 InitializationGroup->True,
 CellChangeTimes->{{3.607460580170146*^9, 3.607460617257656*^9}, {
  3.607460749204588*^9, 3.607460770491681*^9}}],

Cell[BoxData[
 RowBox[{"SmartTensor", "/:", 
  RowBox[{"Position", "[", 
   RowBox[{"v_CircleTimes", ",", 
    RowBox[{"SmartTensor", "[", 
     RowBox[{"t_", ",", "b_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"First", "@@@", 
     RowBox[{"Position", "@@@", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"b", ",", 
         RowBox[{"v", "/.", 
          RowBox[{"CircleTimes", "\[Rule]", "List"}]}]}], "}"}], "]"}]}]}], 
    ",", 
    RowBox[{"{", "1", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.607474498881423*^9, 3.607474517499625*^9}, {
  3.6074758069620934`*^9, 3.607475840902194*^9}}],

Cell[BoxData[
 RowBox[{"SmartTensor", "/:", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"v_CircleTimes", ",", 
    RowBox[{"SmartTensor", "[", 
     RowBox[{"t_", ",", "b_"}], "]"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Part", "[", 
     RowBox[{"t", ",", "##"}], "]"}], "&"}], "@@", 
   RowBox[{"Position", "[", 
    RowBox[{"v", ",", 
     RowBox[{"SmartTensor", "[", 
      RowBox[{"t", ",", "b"}], "]"}]}], "]"}]}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.607460537724822*^9, 3.60746057624536*^9}, {
   3.607460623355948*^9, 3.607460645442834*^9}, {3.607460720167912*^9, 
   3.6074607418866796`*^9}, {3.607460782868884*^9, 3.6074608170608873`*^9}, {
   3.6074608587466373`*^9, 3.607460861772437*^9}, {3.607460903721024*^9, 
   3.6074609148937693`*^9}, {3.6074609815642653`*^9, 3.607460991049406*^9}, {
   3.607461024555603*^9, 3.6074610596408978`*^9}, 3.607461806514976*^9, {
   3.6074620308780937`*^9, 3.60746209037307*^9}, {3.6074621643728943`*^9, 
   3.6074622198126917`*^9}, {3.607462345110466*^9, 3.60746238595814*^9}, {
   3.607462425316716*^9, 3.607462527521373*^9}, {3.6074625621369457`*^9, 
   3.607462690113113*^9}, {3.6074627392334423`*^9, 3.607462803110011*^9}, {
   3.607474522652759*^9, 3.6074745461386547`*^9}, 3.6074758059713287`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Needs", "[", "\"\<Combinatorica`\>\"", "]"}], ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.60746188454907*^9, 3.607461887450768*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transpose", "[", 
   RowBox[{
    RowBox[{"SmartTensor", "[", 
     RowBox[{"t_", ",", "b_"}], "]"}], ",", "n_"}], "]"}], "^:=", 
  RowBox[{"SmartTensor", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"t", ",", "n"}], "]"}], ",", 
    RowBox[{"Permute", "[", 
     RowBox[{"b", ",", "n"}], "]"}]}], "]"}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.6074614642561893`*^9, 3.6074615701106873`*^9}, {
  3.607461639751108*^9, 3.607461680105297*^9}, {3.6074617246629353`*^9, 
  3.607461725146515*^9}, {3.607461809898266*^9, 3.607461811665962*^9}, {
  3.60746287512473*^9, 3.607462892004319*^9}}],

Cell[BoxData[
 RowBox[{"SmartTensor", "/:", 
  RowBox[{"Plus", "[", 
   RowBox[{
    RowBox[{"SmartTensor", "[", 
     RowBox[{"t1_", ",", "b1_"}], "]"}], ",", 
    RowBox[{"SmartTensor", "[", 
     RowBox[{"t2_", ",", "b2_"}], "]"}]}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"b1", "===", "b2"}], ",", 
    RowBox[{"SmartTensor", "[", 
     RowBox[{
      RowBox[{"t1", "+", "t2"}], ",", "b1"}], "]"}], ",", 
    RowBox[{"Throw", "[", "\"\<Basis error\>\"", "]"}]}], "]"}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.607470406318767*^9, 3.607470493503735*^9}, {
  3.60747102841406*^9, 3.607471041324017*^9}, {3.6074723072422543`*^9, 
  3.6074723142628317`*^9}}],

Cell[BoxData[
 RowBox[{"SmartTensor", "/:", 
  RowBox[{"Inner", "[", 
   RowBox[{"f_", ",", 
    RowBox[{"SmartTensor", "[", 
     RowBox[{"t1_", ",", "b1_"}], "]"}], ",", 
    RowBox[{"SmartTensor", "[", 
     RowBox[{"t2_", ",", "b2_"}], "]"}], ",", 
    RowBox[{"g_:", "Plus"}], ",", 
    RowBox[{"n_:", "False"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "m", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "n"}], ",", 
       RowBox[{"m", "=", 
        RowBox[{"Length", "[", "b1", "]"}]}], ",", 
       RowBox[{"m", "=", "n"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"t1", "[", 
         RowBox[{"[", "m", "]"}], "]"}], "===", 
        RowBox[{"t2", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"SmartTensor", "[", 
        RowBox[{
         RowBox[{"Inner", "[", 
          RowBox[{"f", ",", "t1", ",", "t2", ",", "g", ",", "m"}], "]"}], ",", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Delete", "[", 
            RowBox[{"b1", ",", "m"}], "]"}], ",", 
           RowBox[{"Delete", "[", 
            RowBox[{"b2", ",", "1"}], "]"}]}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Throw", "[", "\"\<Basis error\>\"", "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.607462967388489*^9, 3.607463132665015*^9}, {
   3.607463163678319*^9, 3.607463195158148*^9}, {3.6074632740867367`*^9, 
   3.60746330956411*^9}, {3.60746354820068*^9, 3.607463684373279*^9}, {
   3.607463727130526*^9, 3.607463767687932*^9}, {3.60746386504387*^9, 
   3.607463889613779*^9}, {3.607463948223547*^9, 3.6074640130428677`*^9}, {
   3.607464145780551*^9, 3.607464160082211*^9}, {3.6074642267898283`*^9, 
   3.6074642390691547`*^9}, {3.607464316471488*^9, 3.607464321212325*^9}, 
   3.607464374819879*^9, {3.607470369716963*^9, 3.607470400393641*^9}}],

Cell[BoxData[
 RowBox[{"SmartTensor", "/:", 
  RowBox[{"Dot", "[", "tensors__SmartTensor", "]"}], ":=", 
  RowBox[{"Inner", "[", 
   RowBox[{"Times", ",", "tensors"}], "]"}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.607462967388489*^9, 3.607463132665015*^9}, {
   3.607463163678319*^9, 3.607463195158148*^9}, {3.6074632740867367`*^9, 
   3.60746330956411*^9}, {3.60746354820068*^9, 3.607463684373279*^9}, {
   3.607463727130526*^9, 3.607463767687932*^9}, {3.60746386504387*^9, 
   3.607463889613779*^9}, {3.607463948223547*^9, 3.6074640130428677`*^9}, {
   3.607464145780551*^9, 3.607464160082211*^9}, {3.6074642267898283`*^9, 
   3.6074642390691547`*^9}, {3.607464316471488*^9, 3.607464321212325*^9}, 
   3.607464374819879*^9, {3.607464580445866*^9, 3.6074645828752003`*^9}, {
   3.607464622607286*^9, 3.60746465822943*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Package", "Section",
 InitializationGroup->True,
 CellChangeTimes->{{3.598832077806426*^9, 3.5988320795733624`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.5988320817506733`*^9, 3.598832085870481*^9}, {
  3.598833303614431*^9, 3.598833305148703*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tests", "Section",
 CellChangeTimes->{{3.6074698445231037`*^9, 3.6074698451392603`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testBases", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "\[Beta]"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testTensor", "=", 
   RowBox[{"SmartTensor", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "2", ",", "2"}], "}"}]}], "]"}], ",", "testBases"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testBases2", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}]}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testTensor2", "=", 
   RowBox[{"SmartTensor", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "2", ",", "3"}], "}"}]}], "]"}], ",", 
     "testBases2"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.607461836474925*^9, 3.607461841590549*^9}, {
   3.607462292815866*^9, 3.607462304975335*^9}, {3.6074640320008574`*^9, 
   3.607464054529234*^9}, 3.607464349420108*^9, 3.607470023595241*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SmartTensorQ", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.607479873587277*^9, 3.6074798803965273`*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.607479880913403*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"SmartTensorQ", "[", 
    RowBox[{"testTensor2", ",", "patt", ",", "test"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"patt", ",", 
     RowBox[{"Range", "[", "5", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"test", ",", 
     RowBox[{"{", 
      RowBox[{"NumberQ", ",", "ArrayQ"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.607479756807176*^9, 3.607479851841312*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"False", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"False", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"True", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"False", ",", "False"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"False", ",", "False"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6074797620238132`*^9, 3.6074797873011303`*^9}, 
   3.60747985223295*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Coefficient", "[", 
  RowBox[{
   RowBox[{"CircleTimes", "@@", 
    RowBox[{"{", 
     RowBox[{"a", ",", "y", ",", "\[Alpha]"}], "}"}]}], ",", "testTensor"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.607460813023684*^9, 3.607460831828779*^9}, 
   3.607461807657815*^9, {3.6074619722648973`*^9, 3.6074620141874*^9}, {
   3.607462313121565*^9, 3.607462320668935*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.607462316291512*^9, 3.607462321651911*^9}, {
   3.607462392290331*^9, 3.6074624374580383`*^9}, 3.6074624839805107`*^9, 
   3.607462531329425*^9, {3.60746262627875*^9, 3.607462693690196*^9}, {
   3.607462746993203*^9, 3.607462803962803*^9}, 3.607462894787695*^9, {
   3.6074636132728577`*^9, 3.607463621556177*^9}, 3.607463688402725*^9, 
   3.607463739134166*^9, 3.6074637694741*^9, 3.607463890775044*^9, {
   3.607463978890996*^9, 3.6074640142167664`*^9}, {3.607464055549384*^9, 
   3.6074640601451187`*^9}, {3.607464148428219*^9, 3.607464162617379*^9}, {
   3.607464228816131*^9, 3.60746424802785*^9}, 3.6074643222975397`*^9, {
   3.607464354746818*^9, 3.607464375897551*^9}, 3.607464513122938*^9, {
   3.607464659684451*^9, 3.60746468010355*^9}, 3.6074698711716957`*^9, {
   3.607469977952375*^9, 3.607470008628755*^9}, 3.607470275388858*^9, 
   3.6074703394479017`*^9, {3.6074710227117977`*^9, 3.607471042967407*^9}, 
   3.607471675452787*^9, 3.607471757763689*^9, {3.607471791195403*^9, 
   3.607471809339724*^9}, 3.607471897991436*^9, 3.607471978307061*^9, {
   3.6074720704646463`*^9, 3.607472096705768*^9}, 3.60747214076677*^9, 
   3.607472317056045*^9, 3.607472361793111*^9, {3.607472428181273*^9, 
   3.607472466826886*^9}, {3.6074725033967857`*^9, 3.6074725564716578`*^9}, {
   3.607472598529805*^9, 3.6074726691977367`*^9}, 3.6074745495258703`*^9, 
   3.6074758433272038`*^9, {3.607479522030272*^9, 3.607479549126782*^9}, 
   3.6074796004383097`*^9, 3.607479637131369*^9, 3.607479683863633*^9, 
   3.607479721617367*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Pair", "[", "testTensor", "]"}]], "Input",
 CellChangeTimes->{{3.607471726381701*^9, 3.607471734289361*^9}, 
   3.607472161249881*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"a", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Alpha]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"a", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Beta]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"a", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Alpha]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"a", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Beta]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"b", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Alpha]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"b", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Beta]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"b", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Alpha]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"b", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Beta]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"c", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Alpha]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"c", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Beta]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"c", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Alpha]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"c", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Beta]"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.607471734708849*^9, 3.607471758145802*^9}, {
   3.6074717912674828`*^9, 3.60747180944311*^9}, 3.607471898076851*^9, 
   3.607471978991942*^9, {3.607472071146635*^9, 3.6074720974463997`*^9}, {
   3.607472141748147*^9, 3.607472161736628*^9}, 3.607472317120717*^9, 
   3.6074723618613462`*^9, {3.60747242824979*^9, 3.607472466925025*^9}, {
   3.6074725034787292`*^9, 3.607472556552507*^9}, {3.607472598616353*^9, 
   3.607472669298867*^9}, 3.607474549595574*^9, 3.6074758433874273`*^9, {
   3.607479522098895*^9, 3.607479549208496*^9}, 3.607479600683814*^9, 
   3.607479637236019*^9, 3.607479683951215*^9, 3.607479721701296*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Flatten", "[", "testTensor", "]"}]], "Input",
 CellChangeTimes->{{3.607460663137144*^9, 3.60746068354914*^9}, {
  3.607461817842683*^9, 3.6074618456834707`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Alpha]"}], "+", 
  RowBox[{"a", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Beta]"}], "+", 
  RowBox[{"a", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Alpha]"}], "+", 
  RowBox[{"a", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Beta]"}], "+", 
  RowBox[{"b", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Alpha]"}], "+", 
  RowBox[{"b", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Beta]"}], "+", 
  RowBox[{"b", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Alpha]"}], "+", 
  RowBox[{"b", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Beta]"}], "+", 
  RowBox[{"c", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Alpha]"}], "+", 
  RowBox[{"c", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Beta]"}], "+", 
  RowBox[{"c", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Alpha]"}], "+", 
  RowBox[{
  "c", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Beta]"}]}]], "Output",
 CellChangeTimes->{
  3.6074725566389*^9, {3.607472598702237*^9, 3.607472669399137*^9}, 
   3.60747454967822*^9, 3.60747584347887*^9, {3.607479522181592*^9, 
   3.60747954929209*^9}, 3.6074796007917233`*^9, 3.607479637317108*^9, 
   3.607479684027728*^9, 3.607479721783856*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Transpose", "[", 
  RowBox[{"testTensor", ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.607461847273755*^9, 3.607461861254938*^9}}],

Cell[BoxData[
 RowBox[{"SmartTensor", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "\[Beta]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.607472556717991*^9, {3.6074725987692347`*^9, 3.60747266969803*^9}, 
   3.6074745498747053`*^9, 3.607475843799254*^9, {3.6074795222670727`*^9, 
   3.607479549694482*^9}, 3.607479600907936*^9, 3.607479637401651*^9, 
   3.607479684231341*^9, 3.607479722210783*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Flatten", "[", "%", "]"}], "=!=", 
  RowBox[{"Flatten", "[", "testTensor", "]"}]}]], "Input",
 CellChangeTimes->{{3.6074618947250834`*^9, 3.6074619116903133`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.607461906186183*^9, 3.607461914521737*^9}, 
   3.6074619678526297`*^9, 3.60746209876365*^9, 3.6074621959372807`*^9, {
   3.6074623165203047`*^9, 3.607462321798403*^9}, {3.6074623924580307`*^9, 
   3.607462437667753*^9}, 3.6074624842021914`*^9, 3.6074625315691957`*^9, {
   3.607462648660171*^9, 3.6074626939554567`*^9}, {3.6074627472029743`*^9, 
   3.607462804145212*^9}, 3.60746289496959*^9, {3.607463613487103*^9, 
   3.6074636217243347`*^9}, 3.607463688510522*^9, 3.607463739367025*^9, 
   3.607463769675563*^9, 3.60746389099175*^9, {3.607463979077808*^9, 
   3.6074640143677073`*^9}, {3.607464055718974*^9, 3.6074640602493668`*^9}, {
   3.607464148613698*^9, 3.607464162833403*^9}, {3.607464229031885*^9, 
   3.6074642482793503`*^9}, 3.607464322533827*^9, {3.607464354946992*^9, 
   3.607464376097756*^9}, 3.607464513407436*^9, {3.607464659918809*^9, 
   3.60746468037*^9}, 3.60746987134739*^9, {3.6074699781094646`*^9, 
   3.6074700090889177`*^9}, 3.6074702755999727`*^9, 3.607470339845509*^9, {
   3.607471022949025*^9, 3.607471043348878*^9}, 3.607471675854395*^9, 
   3.607471758208275*^9, {3.607471791617125*^9, 3.607471809857411*^9}, 
   3.607471898491117*^9, 3.6074719793132772`*^9, {3.607472071382337*^9, 
   3.6074720978060837`*^9}, 3.607472142171232*^9, 3.6074723173721457`*^9, 
   3.607472362232304*^9, {3.607472428499784*^9, 3.6074724671495237`*^9}, {
   3.607472503735715*^9, 3.6074725568012*^9}, {3.607472598852559*^9, 
   3.607472669780002*^9}, 3.6074745499792633`*^9, 3.607475843885405*^9, {
   3.6074795223473177`*^9, 3.6074795497773457`*^9}, 3.6074796010094337`*^9, 
   3.607479637484782*^9, 3.607479684303093*^9, 3.607479722453903*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Inner", "[", 
  RowBox[{"Times", ",", "testTensor2", ",", "testTensor2"}], "]"}]], "Input",
 CellChangeTimes->{{3.607463745132998*^9, 3.60746377830735*^9}, {
  3.607464058047245*^9, 3.6074640591252337`*^9}}],

Cell[BoxData[
 RowBox[{"SmartTensor", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}]}], "}"}]}], "}"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}]}], "}"}]}],
   "]"}]], "Output",
 CellChangeTimes->{
  3.607464014546831*^9, {3.607464055898224*^9, 3.607464060372755*^9}, {
   3.607464148761752*^9, 3.607464162964473*^9}, {3.607464229162006*^9, 
   3.6074642484107847`*^9}, 3.6074643227039537`*^9, {3.607464354992028*^9, 
   3.607464376163769*^9}, 3.607464513491712*^9, {3.607464659985426*^9, 
   3.607464680470627*^9}, 3.6074698713866453`*^9, {3.6074699782691708`*^9, 
   3.6074700091458683`*^9}, 3.607470275690102*^9, 3.60747033991619*^9, {
   3.607471023550267*^9, 3.607471043437984*^9}, 3.607471675909173*^9, 
   3.6074717582967987`*^9, {3.6074717916800528`*^9, 3.607471809959709*^9}, 
   3.607471898587511*^9, 3.607471979396776*^9, {3.607472071473854*^9, 
   3.607472097882185*^9}, 3.607472142269411*^9, 3.607472317454278*^9, 
   3.607472362315607*^9, {3.607472428720048*^9, 3.607472467387766*^9}, {
   3.607472503965281*^9, 3.607472557023563*^9}, {3.6074725991000643`*^9, 
   3.607472669895372*^9}, 3.6074745500628223`*^9, 3.6074758439851017`*^9, {
   3.607479522431324*^9, 3.607479549860939*^9}, 3.607479601109483*^9, 
   3.607479637552754*^9, 3.607479684383297*^9, 3.607479722623549*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dot", "[", 
  RowBox[{"testTensor2", ",", "testTensor2"}], "]"}]], "Input",
 CellChangeTimes->{{3.6074646651233597`*^9, 3.6074646711888523`*^9}}],

Cell[BoxData[
 RowBox[{"SmartTensor", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "3", ",", "3"}], "}"}]}], "}"}]}], "}"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}]}], "}"}]}],
   "]"}]], "Output",
 CellChangeTimes->{{3.607464671683057*^9, 3.607464680538245*^9}, 
   3.607469871453264*^9, {3.607469978310691*^9, 3.60747000931889*^9}, 
   3.6074702759143057`*^9, 3.607470339985229*^9, {3.607471023618929*^9, 
   3.607471043495586*^9}, 3.607471675989608*^9, 3.607471758399242*^9, {
   3.6074717917862167`*^9, 3.60747181006531*^9}, 3.607471898700852*^9, 
   3.607471979479087*^9, {3.607472071569338*^9, 3.607472097963085*^9}, 
   3.60747214235213*^9, 3.607472317538043*^9, 3.607472362614566*^9, {
   3.6074724288008623`*^9, 3.6074724674616623`*^9}, {3.60747250404335*^9, 
   3.607472557105505*^9}, {3.6074725991696243`*^9, 3.6074726700046597`*^9}, 
   3.6074745501313877`*^9, 3.607475844085002*^9, {3.607479522515286*^9, 
   3.607479549945324*^9}, 3.607479601244911*^9, 3.607479637821554*^9, 
   3.607479684506257*^9, 3.607479722704109*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Pair", "[", "testTensor", "]"}]], "Input",
 CellChangeTimes->{{3.607472228088003*^9, 3.6074722586146793`*^9}, {
  3.607472629248539*^9, 3.607472636454385*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"a", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Alpha]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"a", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Beta]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"a", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Alpha]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"a", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Beta]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"b", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Alpha]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"b", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Beta]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"b", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Alpha]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"b", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Beta]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"c", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Alpha]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"c", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Beta]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"c", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Alpha]"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"c", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Beta]"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.607472240632066*^9, 3.607472255131775*^9}, 
   3.607472317857686*^9, 3.6074723628136997`*^9, {3.6074724288836937`*^9, 
   3.607472467537115*^9}, {3.6074725041327953`*^9, 3.607472557187196*^9}, {
   3.607472599250952*^9, 3.607472670098044*^9}, 3.6074745502149477`*^9, 
   3.6074758441810713`*^9, {3.607479522598576*^9, 3.607479550093762*^9}, 
   3.607479601345552*^9, 3.607479637927249*^9, 3.607479684603804*^9, 
   3.607479722788018*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plus", "@@", 
  RowBox[{"Times", "@@@", "%"}]}]], "Input",
 CellChangeTimes->{{3.607472596824271*^9, 3.6074726187259808`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Alpha]"}], "+", 
  RowBox[{"a", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Beta]"}], "+", 
  RowBox[{"a", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Alpha]"}], "+", 
  RowBox[{"a", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Beta]"}], "+", 
  RowBox[{"b", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Alpha]"}], "+", 
  RowBox[{"b", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Beta]"}], "+", 
  RowBox[{"b", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Alpha]"}], "+", 
  RowBox[{"b", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Beta]"}], "+", 
  RowBox[{"c", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Alpha]"}], "+", 
  RowBox[{"c", "\[CircleTimes]", "x", "\[CircleTimes]", "\[Beta]"}], "+", 
  RowBox[{"c", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Alpha]"}], "+", 
  RowBox[{
  "c", "\[CircleTimes]", "y", "\[CircleTimes]", "\[Beta]"}]}]], "Output",
 CellChangeTimes->{{3.607472599333767*^9, 3.607472670220492*^9}, 
   3.607474550296854*^9, 3.6074758443033457`*^9, {3.607479522882687*^9, 
   3.607479550262762*^9}, 3.607479601477209*^9, 3.607479638038251*^9, 
   3.607479684721406*^9, 3.607479723017408*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"testTensor2", "+", "testTensor2"}]], "Input",
 CellChangeTimes->{{3.607472283582327*^9, 3.607472322723277*^9}}],

Cell[BoxData[
 RowBox[{"SmartTensor", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2", ",", "2"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}]}], "}"}]}],
   "]"}]], "Output",
 CellChangeTimes->{{3.607472286613796*^9, 3.607472318008688*^9}, 
   3.6074723629503603`*^9, {3.607472429050004*^9, 3.607472467673593*^9}, {
   3.607472504298338*^9, 3.607472557271871*^9}, {3.607472599420265*^9, 
   3.607472670334491*^9}, 3.6074745504145603`*^9, 3.607475844416918*^9, {
   3.607479523002277*^9, 3.607479550349381*^9}, 3.607479601763097*^9, 
   3.6074796381573553`*^9, 3.607479684839148*^9, 3.607479723096034*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"testTensor2", "+", "testTensor"}]], "Input",
 CellChangeTimes->{{3.607472269367704*^9, 3.60747227884052*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Throw", "::", "\<\"nocatch\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Uncaught \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(Throw[\\\"Basis \
error\\\"]\\), \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" \
returned to top level.\\\\\\\"\\\", \\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Throw/nocatch\\\", ButtonNote -> \
\\\"Throw::nocatch\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.6074722792358103`*^9, 3.60747231809166*^9, 3.6074723630281677`*^9, {
   3.607472429132248*^9, 3.60747246774387*^9}, {3.607472504383819*^9, 
   3.60747255735375*^9}, {3.607472599520707*^9, 3.607472670433228*^9}, 
   3.607474550476449*^9, 3.6074758445521307`*^9, {3.6074795231033297`*^9, 
   3.607479550575396*^9}, 3.607479601862061*^9, 3.60747963827612*^9, 
   3.6074796849572067`*^9, 3.607479723174677*^9}],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  RowBox[{"Throw", "[", "\<\"Basis error\"\>", "]"}], "]"}]], "Output",
 CellChangeTimes->{{3.607472276890994*^9, 3.607472279246538*^9}, 
   3.6074723180933857`*^9, 3.607472363029685*^9, {3.607472429134007*^9, 
   3.607472467745571*^9}, {3.6074725043856707`*^9, 3.607472557355514*^9}, {
   3.6074725995729637`*^9, 3.607472670491024*^9}, 3.6074745504783297`*^9, 
   3.607475844591646*^9, {3.607479523156583*^9, 3.60747955057717*^9}, 
   3.607479601918015*^9, 3.60747963833108*^9, 3.607479685009983*^9, 
   3.60747972317632*^9}]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1278, 1396},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
ShowSelection->True,
Background->RGBColor[0.88, 1, 0.88],
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (February 18, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 239, 3, 100, "Section"],
Cell[CellGroupData[{
Cell[831, 29, 570, 10, 64, "Input"],
Cell[1404, 41, 748, 14, 32, "Message"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2201, 61, 126, 2, 100, "Section",
 InitializationGroup->True],
Cell[2330, 65, 540, 10, 40, "Input",
 InitializationGroup->True],
Cell[2873, 77, 664, 18, 110, "Input"],
Cell[3540, 97, 212, 5, 40, "Input",
 InitializationGroup->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[3789, 107, 170, 3, 100, "Section",
 InitializationGroup->True],
Cell[3962, 112, 122, 2, 40, "Input",
 InitializationGroup->True],
Cell[4087, 116, 670, 15, 62, "Text",
 InitializationGroup->True],
Cell[CellGroupData[{
Cell[4782, 135, 292, 6, 42, "Input",
 InitializationGroup->True],
Cell[5077, 143, 1918, 29, 42, "Output",
 InitializationGroup->True]
}, Open  ]],
Cell[7010, 175, 159, 2, 39, "Text",
 InitializationGroup->True],
Cell[7172, 179, 2166, 52, 136, "Input",
 InitializationGroup->True],
Cell[9341, 233, 263, 7, 39, "Text",
 InitializationGroup->True],
Cell[9607, 242, 291, 7, 42, "Input",
 InitializationGroup->True],
Cell[9901, 251, 283, 7, 39, "Text",
 InitializationGroup->True],
Cell[10187, 260, 747, 15, 42, "Input",
 InitializationGroup->True],
Cell[10937, 277, 580, 16, 42, "Input"],
Cell[11520, 295, 161, 2, 39, "Text",
 InitializationGroup->True],
Cell[11684, 299, 252, 6, 39, "Text",
 InitializationGroup->True],
Cell[11939, 307, 659, 18, 65, "Input"],
Cell[12601, 327, 1290, 25, 65, "Input",
 InitializationGroup->True],
Cell[13894, 354, 190, 4, 40, "Input",
 InitializationGroup->True],
Cell[14087, 360, 660, 16, 42, "Input",
 InitializationGroup->True],
Cell[14750, 378, 701, 18, 65, "Input",
 InitializationGroup->True],
Cell[15454, 398, 2089, 49, 180, "Input",
 InitializationGroup->True],
Cell[17546, 449, 846, 14, 42, "Input",
 InitializationGroup->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[18429, 468, 126, 2, 100, "Section",
 InitializationGroup->True],
Cell[18558, 472, 293, 7, 64, "Input",
 InitializationGroup->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[18888, 484, 94, 1, 100, "Section"],
Cell[18985, 487, 1456, 43, 110, "Input"],
Cell[CellGroupData[{
Cell[20466, 534, 133, 2, 40, "Input"],
Cell[20602, 538, 74, 1, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20713, 544, 451, 12, 40, "Input"],
Cell[21167, 558, 482, 14, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21686, 577, 390, 9, 40, "Input"],
Cell[22079, 588, 1582, 22, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23698, 615, 158, 3, 40, "Input"],
Cell[23859, 620, 2291, 59, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26187, 684, 185, 3, 40, "Input"],
Cell[26375, 689, 1217, 19, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27629, 713, 219, 5, 40, "Input"],
Cell[27851, 720, 1038, 29, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28926, 754, 198, 4, 40, "Input"],
Cell[29127, 760, 1711, 23, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30875, 788, 231, 4, 40, "Input"],
Cell[31109, 794, 2942, 74, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34088, 873, 169, 3, 40, "Input"],
Cell[34260, 878, 2668, 70, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36965, 953, 183, 3, 40, "Input"],
Cell[37151, 958, 2103, 57, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39291, 1020, 150, 3, 40, "Input"],
Cell[39444, 1025, 1197, 18, 40, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40678, 1048, 135, 2, 40, "Input"],
Cell[40816, 1052, 1399, 37, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42252, 1094, 133, 2, 40, "Input"],
Cell[42388, 1098, 994, 17, 32, "Message"],
Cell[43385, 1117, 563, 9, 40, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
