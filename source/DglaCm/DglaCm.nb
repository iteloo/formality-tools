(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     17152,        446]
NotebookOptionsPosition[     15396,        381]
NotebookOutlinePosition[     15907,        400]
CellTagsIndexPosition[     15864,        397]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "Dgla describing the critical locus of a function on ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["C", "m"], TraditionalForm]], "None",
  FormatType->"TraditionalForm"]
}], "Title",
 CellChangeTimes->{{3.590080300394196*^9, 3.5900803157196827`*^9}, {
   3.5901148168207073`*^9, 3.590114819411425*^9}, 3.590129760422965*^9, 
   3.5901322094540052`*^9, {3.599859890262459*^9, 3.599859907145545*^9}}],

Cell[CellGroupData[{

Cell["Setup", "Section",
 CellChangeTimes->{{3.590037145002685*^9, 3.59003715338137*^9}, {
  3.590037338403248*^9, 3.590037339340391*^9}, {3.5900801592555304`*^9, 
  3.590080160819013*^9}, {3.5988309447417707`*^9, 3.5988309455734873`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"Background", "\[Rule]", "LightGreen"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "\[Rule]", "Automatic"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.5901111141260853`*^9, 3.590111117027101*^9}, 
   3.590429315764176*^9, {3.5906395513904467`*^9, 3.5906395741266537`*^9}, {
   3.590639727954274*^9, 3.5906397289419622`*^9}, {3.590640677058509*^9, 
   3.590640795046383*^9}, {3.590694488220809*^9, 3.590694547672426*^9}, 
   3.598830940704482*^9, {3.599860650603125*^9, 3.599860688152547*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Remove", "::", "\<\"rmnsm\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"There are no symbols \
matching \\\\\\\\\\\\\\\"\\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(\\\"Global`*\\\"\\), \\\"MT\\\
\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\"\\\\\\\\\\\\\\\".\\\\\\\"\\\", \
\\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Remove/rmnsm\\\", ButtonNote -> \
\\\"Remove::rmnsm\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.59986067038488*^9, 3.599860689653101*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Begin Package", "Section",
 InitializationGroup->True,
 CellChangeTimes->{{3.598831399413019*^9, 3.598831400987857*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", 
   RowBox[{"\"\<FormalityTools`DglaCm`\>\"", ",", 
    RowBox[{"{", "\"\<FormalityTools`Helpers`\>\"", "}"}]}], "]"}], 
  ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.598829475229063*^9, 3.598829478261488*^9}, 
   3.598831440104094*^9, {3.598831952187162*^9, 3.5988319644094954`*^9}, {
   3.598833274616651*^9, 3.598833293695784*^9}, {3.598905347051097*^9, 
   3.598905355750904*^9}, {3.5989054307688217`*^9, 3.598905437638081*^9}, {
   3.599854626767277*^9, 3.599854628244357*^9}, {3.59985984352569*^9, 
   3.599859845266398*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetupDgla", "::", "usage"}], "=", 
   "\"\<Set up the dgla associated with the critical locus of the input \
function.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CleanDgla", "::", "usage"}], "=", "\"\<Clean up the dgla.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Dgla", "::", "usage"}], "=", 
   "\"\<Returns the dgla associated with the critical locus of the input \
function. Currently will override previous SetupDgla\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d", "::", "usage"}], "=", "\"\<The differential\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c", "::", "usage"}], "=", "\"\<The graded Lie bracket\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"basis", "::", "usage"}], "=", 
   "\"\<The basis of the complex.\>\""}], ";"}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.598829543865987*^9, 3.598829635002733*^9}, {
  3.598829896624269*^9, 3.5988299564366713`*^9}, {3.59883145729143*^9, 
  3.5988317604244967`*^9}, {3.598831812446887*^9, 3.598831837516721*^9}, {
  3.598831968690402*^9, 3.5988319837382317`*^9}, {3.5988321826631517`*^9, 
  3.598832189325981*^9}, {3.5988332557760067`*^9, 3.598833259581984*^9}, {
  3.598833446881077*^9, 3.598833456660015*^9}, {3.598946165274426*^9, 
  3.5989461692341967`*^9}, {3.598946569811266*^9, 3.598946570041094*^9}, {
  3.599859849913715*^9, 3.5998598846157312`*^9}, {3.599865904591044*^9, 
  3.5998659414374113`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.598829499388723*^9, 3.598829508019981*^9}, 
   3.598833295974461*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interface functions", "Section",
 InitializationGroup->True,
 CellChangeTimes->{{3.5988320144346113`*^9, 3.598832029934391*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetupDgla", "[", "fin_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CleanDgla", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"f", "=", "fin"}], ";", "\[IndentingNewLine]", 
     RowBox[{"vars", "=", 
      RowBox[{"Variables", "[", "f", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"varsMat", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", "vars", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dd", "=", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", "vars", "}"}]}], "]"}], "&"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"evalAtOrigin", "=", 
      RowBox[{
       RowBox[{"#", "/.", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"x", "\[Rule]", "0"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "vars"}], "}"}]}], "]"}]}], "&"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nonzeroDegrees", "=", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.59883203331518*^9, 3.598832052984171*^9}, {
   3.598832506763461*^9, 3.598832562937696*^9}, {3.59883381554957*^9, 
   3.598833816389749*^9}, {3.598833853771262*^9, 3.5988338540899677`*^9}, {
   3.599860084147685*^9, 3.599860085423093*^9}, {3.599860144608371*^9, 
   3.599860167567932*^9}, {3.599860205442437*^9, 3.599860205925251*^9}, {
   3.599860328625951*^9, 3.59986036446362*^9}, {3.599860467145946*^9, 
   3.5998604677674017`*^9}, 3.599865338296668*^9, {3.5998654568081007`*^9, 
   3.5998655027108307`*^9}, {3.59986558537519*^9, 3.5998655854780293`*^9}, {
   3.599878813541889*^9, 3.5998788235943527`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CleanDgla", "[", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ClearCache", "/@", 
      RowBox[{"Unevaluated", "/@", 
       RowBox[{"Unevaluated", "[", 
        RowBox[{"{", 
         RowBox[{
         "f", ",", "vars", ",", "varsMat", ",", "dd", ",", "evalAtOrigin", 
          ",", "nonzeroDegrees", ",", "c", ",", "d"}], "}"}], "]"}]}]}], 
     ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.5988320556360617`*^9, 3.598832056067478*^9}, {
   3.598832110409484*^9, 3.5988321306061363`*^9}, {3.598832203215395*^9, 
   3.598832220291751*^9}, {3.598832355332942*^9, 3.598832374137192*^9}, {
   3.5988324296085978`*^9, 3.598832430255547*^9}, {3.598833088106523*^9, 
   3.598833210194906*^9}, {3.598833348129507*^9, 3.59883334819083*^9}, {
   3.598834269534058*^9, 3.5988342697155113`*^9}, {3.5988343039167128`*^9, 
   3.598834321289576*^9}, {3.598843972811021*^9, 3.59884402698774*^9}, {
   3.598844063752738*^9, 3.598844068045516*^9}, {3.5988443486766*^9, 
   3.598844353041111*^9}, {3.598844459565529*^9, 3.5988444821333838`*^9}, {
   3.598844683935093*^9, 3.5988446931662703`*^9}, {3.598844906006074*^9, 
   3.5988449074589043`*^9}, {3.598845231821103*^9, 3.59884523510046*^9}, {
   3.598845360006742*^9, 3.598845388968148*^9}, {3.598845549570895*^9, 
   3.5988455511857643`*^9}, {3.598845608753483*^9, 3.598845644339766*^9}, {
   3.598845678573004*^9, 3.5988456796888943`*^9}, {3.598845752637348*^9, 
   3.5988458103186293`*^9}, {3.598861999955428*^9, 3.598862005355906*^9}, {
   3.5988621608129673`*^9, 3.5988621918983088`*^9}, {3.598862453027624*^9, 
   3.598862471467989*^9}, {3.598862588637209*^9, 3.598862599705934*^9}, {
   3.598862636947793*^9, 3.59886263962237*^9}, {3.5988628155292187`*^9, 
   3.59886285653824*^9}, {3.598862901788773*^9, 3.5988629061375303`*^9}, {
   3.598863191250255*^9, 3.59886319518215*^9}, {3.598902784693637*^9, 
   3.5989027895251007`*^9}, {3.598945845868635*^9, 3.598945847984696*^9}, {
   3.598946080807205*^9, 3.598946110939312*^9}, 3.598946575780085*^9, {
   3.599860263526998*^9, 3.599860283185298*^9}, {3.599862055265089*^9, 
   3.599862074039558*^9}, {3.5998631837834873`*^9, 3.5998631840962687`*^9}, {
   3.599865509545356*^9, 3.599865542866843*^9}, {3.5998788523161383`*^9, 
   3.5998788538487597`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dgla", "[", "fin_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "result", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SetupDgla", "[", "fin", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"d", "[", "i", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Select", "[", 
             RowBox[{"nonzeroDegrees", ",", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"nonzeroDegrees", ",", 
                 RowBox[{"#", "+", "1"}]}], "]"}], "&"}]}], "]"}]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"i", "=", 
               RowBox[{"\[Alpha]", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{"j", "=", 
               RowBox[{"\[Alpha]", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}], ",", 
              RowBox[{"c", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"Outer", "[", 
                 RowBox[{
                 "List", ",", "nonzeroDegrees", ",", "nonzeroDegrees"}], 
                 "]"}], ",", "1"}], "]"}], ",", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"nonzeroDegrees", ",", 
                 RowBox[{"Plus", "@@", "#"}]}], "]"}], "&"}]}], "]"}]}], 
           "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"CleanDgla", "[", "]"}], ";", "\[IndentingNewLine]", 
     "result"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQbaGVYW914ZXjg3klLiB6U9uTGyD6/Pr8hyD6zdSn
92OA9PQriU9B9LWEYK0iIN3LXaIHouecKTYH0W2394FpOYedfiBa+95/fxCd
5Pi9C0TP26LfDaJfvX02AUTvU2WfCKJ1QqJmgGipqDow/W3ahvsg2tnS9RGI
vl4loW9w6ZXjHTdDMB2kahYAol0eOQSC6DcL1yaB5VlYMkB0h2V2L4juOZ8P
plc5F04Eq+8+PwlEnzEqmw6i1ypPnQmis5pezgXRXh/7loHN44paBaK7bnlt
B9GJy1hug+gkb7UHIHpJH9MLsDtWqL0F0T4iH/+A9V3Y/BdEGzrlMBsC6fcM
d1hAdIynuxiIXndLWx5Ea6RvCLEE0lE77cNANAAuN85j
  "]],

Cell[BoxData[
 RowBox[{"basis", ":=", "vars"}]], "Input",
 CellChangeTimes->{{3.5998659626123047`*^9, 3.599865998171282*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["d", "i"], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["c", "ij"], TraditionalForm]], "None"]
}], "Section",
 InitializationGroup->True,
 CellChangeTimes->{{3.598831172174767*^9, 3.598831177049596*^9}, {
  3.598950826080512*^9, 3.5989508429902554`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", "[", "i_", "]"}], ":=", 
  RowBox[{
   RowBox[{"d", "[", "i", "]"}], "=", 
   RowBox[{"SparseArray", "@", 
    RowBox[{"evalAtOrigin", "@", 
     RowBox[{"dd", "@", 
      RowBox[{"dd", "[", "f", "]"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.5901149972445917`*^9, 3.5901150290416727`*^9}, {
   3.590115114298265*^9, 3.5901151163100653`*^9}, {3.590115201391692*^9, 
   3.590115224405896*^9}, {3.590115308333667*^9, 3.5901153404355288`*^9}, {
   3.590115394004285*^9, 3.590115397325384*^9}, {3.590115796057517*^9, 
   3.5901157986961937`*^9}, 3.5901297604376183`*^9, 3.590132209473846*^9, {
   3.590133388243328*^9, 3.590133402781769*^9}, 3.590371518832013*^9, {
   3.5998600284510612`*^9, 3.599860040423211*^9}, {3.599860115765025*^9, 
   3.5998601181978893`*^9}, {3.599860382938101*^9, 3.599860383155057*^9}, {
   3.599862091891087*^9, 3.5998621211551647`*^9}, {3.59986218042658*^9, 
   3.599862181305201*^9}, {3.5998622215014143`*^9, 3.5998622254496326`*^9}, {
   3.599865600685771*^9, 3.5998656056741543`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"c", "[", 
    RowBox[{"i", ",", "j"}], "]"}], "=", 
   RowBox[{"SparseArray", "@", 
    RowBox[{"evalAtOrigin", "@", 
     RowBox[{"dd", "@", 
      RowBox[{"dd", "@", 
       RowBox[{"dd", "[", "f", "]"}]}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.590115345776676*^9, 3.5901153923224163`*^9}, {
   3.5901157884104843`*^9, 3.5901158003999233`*^9}, 3.59012976043953*^9, 
   3.590132209475667*^9, {3.59013246112035*^9, 3.5901324631040087`*^9}, {
   3.590133390933193*^9, 3.590133398813199*^9}, {3.590136495603487*^9, 
   3.590136516527275*^9}, {3.590371380306432*^9, 3.590371381527532*^9}, 
   3.590371522791177*^9, 3.599860058372672*^9, {3.599860105132576*^9, 
   3.5998601231514397`*^9}, 3.599860385460259*^9, 3.599860493324291*^9, {
   3.599862096732753*^9, 3.599862119375823*^9}, {3.59986219091462*^9, 
   3.59986221845079*^9}, {3.599865607202839*^9, 3.599865611066771*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["End Package", "Section",
 InitializationGroup->True,
 CellChangeTimes->{{3.598832077806426*^9, 3.5988320795733624`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationGroup->True,
 CellChangeTimes->{{3.5988320817506733`*^9, 3.598832085870481*^9}, {
  3.598833303614431*^9, 3.598833305148703*^9}}]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1278, 1396},
WindowMargins->{{Automatic, 342}, {Automatic, 0}},
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.5, 1.5 Inherited],
Background->RGBColor[0.88, 1, 0.88],
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (February 18, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 416, 9, 188, "Title"],
Cell[CellGroupData[{
Cell[863, 28, 239, 3, 100, "Section"],
Cell[CellGroupData[{
Cell[1127, 35, 807, 16, 87, "Input"],
Cell[1937, 53, 648, 12, 32, "Message"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2634, 71, 126, 2, 100, "Section",
 InitializationGroup->True],
Cell[2763, 75, 609, 12, 40, "Input",
 InitializationGroup->True],
Cell[3375, 89, 1586, 37, 202, "Input",
 InitializationGroup->True],
Cell[4964, 128, 212, 5, 40, "Input",
 InitializationGroup->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[5213, 138, 134, 2, 100, "Section",
 InitializationGroup->True],
Cell[5350, 142, 1839, 42, 226, "Input",
 InitializationGroup->True],
Cell[7192, 186, 2425, 41, 87, "Input",
 InitializationGroup->True],
Cell[9620, 229, 2735, 69, 272, "Input"],
Cell[12358, 300, 125, 2, 40, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12520, 307, 339, 11, 105, "Section",
 InitializationGroup->True],
Cell[12862, 320, 1054, 19, 63, "Input"],
Cell[13919, 341, 990, 20, 63, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14946, 366, 126, 2, 150, "Section",
 InitializationGroup->True],
Cell[15075, 370, 293, 7, 96, "Input",
 InitializationGroup->True]
}, Open  ]]
}, Open  ]]
}
]
*)

